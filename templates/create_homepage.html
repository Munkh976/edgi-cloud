<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=0.9">
    <title>Template Editor - {{ db_name }}</title>
    <script src="https://cdn.tailwindcss.com/3.4.16"></script>
    <script src="/static/js/tailwind.config.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.6.0/remixicon.min.css">
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
    <header>
        <nav>
            <ul>
                <li><a href="/dashboard">Dashboard</a></li>
                <li><a href="/manage-databases">Manage Databases</a></li>
                {% if actor.role == "system_admin" %}
                    <li><a href="/system-admin">System Admin</a></li>
                {% endif %}
                <li><a href="/change-password">Change Password</a></li>
                <li><a href="/logout">Logout</a></li>
            </ul>
        </nav>
    </header>
    <main>
        <h1>Template Editor - {{ db_name }} ({{ db_status }})</h1>
        {% if success %}
            <p style="color: green;">{{ success }}</p>
        {% endif %}
        {% if error %}
            <p style="color: red;">{{ error }}</p>
        {% endif %}
        <section>
            <h2>Website Title</h2>
            <p>Current: {{ content.title.content | default(db_name) }}</p>
            <form method="post">
                <label for="title">Title:</label>
                <input type="text" id="title" name="title" value="{{ content.title.content | default(db_name) }}">
                <button type="submit">Update Title</button>
            </form>
        </section>
        <section>
            <h2>Header Image</h2>
            {% if content.header_image.image_url %}
                <img src="{{ content.header_image.image_url }}" alt="{{ content.header_image.alt_text | default('Environmental Data') }}">
                {% if content.header_image.credit_url %}
                    <p><a href="{{ content.header_image.credit_url }}">{{ content.header_image.credit_text | default('Image by EDGI') }}</a></p>
                {% else %}
                    <p>{{ content.header_image.credit_text | default('Image by EDGI') }}</p>
                {% endif %}
            {% endif %}
            <form method="post" enctype="multipart/form-data">
                <label for="image">Upload New Image (jpg, png, max 5MB):</label>
                <input type="file" id="image" name="image" accept=".jpg,.png">
                <label for="alt_text">Alt Text:</label>
                <input type="text" id="alt_text" name="alt_text" value="{{ content.header_image.alt_text | default('') }}">
                <label for="credit_text">Credit Text:</label>
                <input type="text" id="credit_text" name="credit_text" value="{{ content.header_image.credit_text | default('') }}">
                <label for="credit_url">Credit URL:</label>
                <input type="text" id="credit_url" name="credit_url" value="{{ content.header_image.credit_url | default('') }}">
                <button type="submit">Update Header Image</button>
            </form>
        </section>
        <section>
            <h2>Description</h2>
            <p>Current: {{ content.description.content | default('') }}</p>
            <form method="post">
                <label for="description">Description (Markdown):</label>
                <textarea id="description" name="description">{{ content.description.content | default('') }}</textarea>
                <button type="submit">Update Description</button>
            </form>
        </section>
        <section>
            <h2>Footer</h2>
            <p>Current: {{ content.footer.content | default('Made with EDGI') }}</p>
            {% for paragraph in content.footer.paragraphs | default(['Made with EDGI']) %}
                <p>{{ paragraph | safe }}</p>
            {% endfor %}
            <form method="post">
                <label for="footer">Footer Content (Markdown):</label>
                <textarea id="footer" name="footer">{{ content.footer.content | default('Made with EDGI') }}</textarea>
                <button type="submit">Update Footer</button>
            </form>
        </section>
        <section>
            <h2>Actions</h2>
            <p><a href="/dashboard">Back to Dashboard</a></p>
            <p><a href="/{{ db_name }}/tables">Manage Tables</a></p>
            {% if db_status == "Published" %}
                <p><a href="/{{ db_name }}">View Homepage</a></p>
            {% endif %}
        </section>
    </main>
    <footer>
        {% for paragraph in content.footer.paragraphs | default(["Made with EDGI"]) %}
            <p>{{ paragraph | safe }}</p>
        {% endfor %}
        <p>{{ content.footer.odbl_text | default('Data licensed under ODbL') }}</p>
    </footer>
</body>
</html>